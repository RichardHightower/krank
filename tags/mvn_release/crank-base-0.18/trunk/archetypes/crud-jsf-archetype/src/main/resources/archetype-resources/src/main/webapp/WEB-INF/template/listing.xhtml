<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:z="http://www.qualcomm.com/jsf/core"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:a4j="https://ajax4jsf.dev.java.net/ajax"
	xmlns:rich="http://richfaces.ajax4jsf.org/rich"
	xmlns:crank="http://www.googlecode.com/crank"
	xmlns:crud="http://www.googlecode.com/crank/crud">

<ui:composition>

	<div id="editTip" class="toolTip">Edit this record</div>
	<div id="deleteTip" class="toolTip">Delete this record</div>
	
	<!-- DEFINE VARIABLES -->
	<c:if test="${idBase}">
		<c:set var="idBase" value="${paginator.name}Listing"/>
	</c:if>
	<c:if test="${empty id}">
		<c:set var="id" value="${idBase}" />
	</c:if>
	<c:if test="${empty reRender}">
		<c:set var="reRender" value="panelGroup${id}" />
	</c:if>
	<c:if test="${empty numRows}">
		<c:set var="numRows" value="10" />
	</c:if>
	<c:if test="${empty dataTableWidth}">
		<c:set var="${dataTableWidth}" value="100%" />
	</c:if>


	<!-- Style classes -->
	<c:if test="${empty listingCommandButtonClass}">
		<c:set var="listingCommandButtonClass" value="commandButtonClass" />
	</c:if>
	<c:if test="${empty listingCommandLinkClass}">
		<c:set var="listingCommandLinkClass" value="commandLinkClass" />
	</c:if>
	<c:if test="${empty listingOutputTextClass}">
		<c:set var="listingOutputTextClass" value="listingOutputText" />
	</c:if>
	<c:if test="${empty listingDataTableColumnClasses}">
		<c:set var="listingDataTableColumnClasses"
			value="dataTableColumnClasses" />
	</c:if>
	<c:if test="${empty listingDataTableRowClasses}">
		<c:set var="listingDataTableRowClasses" value="oddRow, evenRow" />
	</c:if>
	<c:if test="${empty listingFooterClass}">
		<c:set var="listingFooterClass" value="listingFooter" />
	</c:if>
	<c:if test="${empty listingImageButtonClass}">
		<c:set var="listingImageButtonClass" value="paginationImageButton" />
	</c:if>

	<c:set var="pNames" value="${fn:split(propertyNames, ',')}" />
	
	
	<a4j:outputPanel id="${idBase}AjaxOutputPanel" ajaxRendered="true">
		
		<h:panelGrid id="${reRender}" columns="1" width="${dataTableWidth}">
		
		
			<crank:paginator paginator="${paginator}" reRender="${reRender}" >
			    <a4j:commandLink  id="${idBase}AddEntityLink"
						action="${crud.loadCreate}"
						value="Add New ${crud:createLabel(jsfCrudAdapter.controller.name)}" reRender="${reRender}"/>		
			</crank:paginator>

	
			<rich:dataTable width="${dataTableWidth}" id="${idBase}DataTable"
				rows="${numRows}" columnClasses="${listingDataTableColumnClasses}"
				rowClasses="${listingDataTableRowClasses}"
				value="#{jsfCrudAdapter.model}" var="row">
				<f:facet name="header">
					<rich:columnGroup>
						<h:column>
							<crank:commandLink id="${idBase}SelectAll"
											   onclick="toggleAllCheckBoxes('${parentForm}',true);"
							                   toolTipText="Click to select all rows">
								<h:graphicImage id="${idBase}SelectAllGraphic" value="/images/selected-sm.gif" border="0" styleClass="${listingImageButtonClass}"/>
							</crank:commandLink>
							<crank:commandLink id="${idBase}SelectNone"
							                   onclick="toggleAllCheckBoxes('${parentForm}',false);"
							                   toolTipText="Click to un-select all rows">
								<h:graphicImage id="${idBase}SelectNoneGraphic" value="/images/unselected-sm.gif" border="0" styleClass="${listingImageButtonClass}"/>
							</crank:commandLink>
							<crank:commandLink id="${idBase}DeleteSelected"
											   entity="${crud}"
											   action="deleteSelected"
											   onclick="if (!confirm('Are you sure you want to delete all selected items?')) return false"
							                   toolTipText="Click to delete selected rows">
								<h:graphicImage id="${idBase}DeleteSelectedGraphic" value="/images/del-alt-sm.gif" border="0" styleClass="${listingImageButtonClass}"/>
							</crank:commandLink>
						</h:column>
						<c:forEach items="${pNames}" var="property">
							<crank:header fieldName="${property}" paginator="${paginator}"
								reRender="${reRender}" />
						</c:forEach>
						<h:column >
							<h:outputText value="Action" />
						</h:column>
					</rich:columnGroup>
	
				</f:facet>
				
				<f:facet name="footer">
					<h:panelGroup id="${idBase}FooterPanel" styleClass="${listingFooterClass}">
						<h:outputText
						 	id="${idBase}PaginatorStatusText"
							styleClass="${listingOutputTextClass}"
							value="Page #{paginator.currentPageNumber+1} of #{paginator.pageCount}" />
					</h:panelGroup>
				</f:facet>
				
				<h:column id="${idBase}SelectColumn">
	   				<h:selectBooleanCheckbox id="${idBase}SelectCheckBox" value="#{row.selected}" styleClass="imageCenter"/>
				</h:column>
				
				<c:forEach items="${pNames}" var="property">
					<c:set var='idName' value='${crud:replace(property, ".", "_")}'/>
					<h:column>
						<c:choose>
							<c:when test="${crud:contains(property, '.')}">
								<c:choose>
									<c:when test="${crud:isBoolean(crud.entityClass,property)}">
										<h:graphicImage value="/images/check-sm.gif"
											rendered="${(row.map[property] == 'true')}"
											styleClass="imageCenter" />
									</c:when>
									<c:otherwise>
										<h:outputText value="#{row.map[property]}" />
									</c:otherwise>
								</c:choose>
							</c:when>
							<c:otherwise>
								<c:choose>
									<c:when test="${crud:isBoolean(crud.entityClass,property)}">
										<h:graphicImage value="/images/check-sm.gif"
											rendered="${(row.object[property] == 'true')}"
											styleClass="imageCenter" />
									</c:when>
									<c:otherwise>
										<h:outputText value="#{row.object[property]}" />
									</c:otherwise>
								</c:choose>
							</c:otherwise>
						</c:choose>
					</h:column>
				</c:forEach>
				
				<h:column>
					<h:commandLink id="${idBase}ReadCommandLink" action="${crud.read}"  onmouseout="popUp(event,'editTip')" onmouseover="popUp(event,'editTip')">
							<h:graphicImage value="/images/edit-sm.gif" border="0" styleClass="${listingImageButtonClass}" />
					</h:commandLink>
					&nbsp;
					<h:commandLink id="${idBase}DeleteCommandLink"
						action="${crud.delete}"  
						onclick="if (!confirm('Are you sure you want to delete this item?')) return false"
						onmouseout="popUp(event,'deleteTip')" 
						onmouseover="popUp(event,'deleteTip')">
							<h:graphicImage value="/images/del-sm.gif" border="0" styleClass="${listingImageButtonClass}"/>
					</h:commandLink>
				</h:column>
				
			</rich:dataTable>
		</h:panelGrid>
	</a4j:outputPanel>
	
</ui:composition>
</html>
