<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" 
      xmlns:ui="http://java.sun.com/jsf/facelets" 
      xmlns:h="http://java.sun.com/jsf/html" 
      xmlns:f="http://java.sun.com/jsf/core" 
      xmlns:c="http://java.sun.com/jstl/core"
	  xmlns:fn="http://java.sun.com/jsp/jstl/functions"   
	  xmlns:a4j="https://ajax4jsf.dev.java.net/ajax"	  
      xmlns:t="http://myfaces.apache.org/tomahawk"
	  xmlns:crud="http://www.googlecode.com/crank/crud"
	  xmlns:crank="http://www.googlecode.com/crank"	
      >

  <ui:composition>

  	<c:if test="${empty ajax}">
  		<c:set var="ajax" value="false"/>
  	</c:if>

  	<c:if test="${empty cancelAlwaysOn}">
  		<c:set var="cancelAlwaysOn" value="false"/>
  	</c:if>

  	<c:if test="${empty hideCancel}">
  		<c:set var="hideCancel" value="false"/>
  	</c:if>

  	<c:if test="${empty formButtonClass}">
  		<c:set var="formButtonClass" value="paginationGroupButton"/>
  	</c:if>
  	
  	<c:if test="${empty rendered}">
  		<c:set var="rendered" value="true"/>
  	</c:if>

	<c:when test="${(not empty reRender) and ajax}">
		<c:set var="reRenderers" value="${reRender},buttons${id}" />
	</c:when>
	
	<c:set var="pNames" value="${fn:split(propertyNames, ',')}" />
	
	<c:if test="${not empty exclusiveGroups}">
		<c:set var="eGroups" value="${fn:split(exclusiveGroups, ',')}" />
	</c:if>

		<h:panelGrid id="formLayout${id}" columns="1" rendered="${rendered and ((crud.state=='ADD') or (crud.state == 'EDIT'))}">
			<!-- Main for fields -->
		    <h:panelGrid columns="3" rowClasses="formRowClass1, formRowClass2">
				<c:forEach items="${pNames}" var="property">
					<crank:field entity="#{crud.entity}" crud="${crud}" type="${crud.entityClass}" fieldName="${property}" daoName="${daoName}"/>
				</c:forEach>			
		    </h:panelGrid>
		    
			<!-- Radio Groups -->
			<c:if test="${not empty exclusiveGroups}">
			    <h:panelGrid columns="1" rowClasses="radioGroup" cellspacing="5" width="100%">
					<c:set var="counter" value="0"/>
					<c:forEach items="${eGroups}" var="group">
						<c:set var="groupId" value="${daoName}Group${counter}"/>
						<c:set var="exclusiveBoxes" value="${fn:split(group, ':')}"/>
						<h:panelGrid columns="3">
							<c:forEach items="${exclusiveBoxes}" var="exclusiveField">
							    <c:if test="${crud:isBoolean(crud.entityClass,exclusiveField)}">
									<crank:field 
										fieldId="${groupId}${exclusiveField}"
									    onclick="setExclusiveGroup('${parentForm}','${exclusiveField}','${groupId}',false);"
										entity="#{crud.entity}" 
										type="${crud.entityClass}" 
										crud="${crud}" 
										fieldName="${exclusiveField}" 
										daoName="${daoName}"/>
								</c:if>
							</c:forEach>
						</h:panelGrid>
						<c:set var="counter" value="${counter + 1}"/>
					</c:forEach>	
			    </h:panelGrid>
			</c:if>
					    
		    <ui:insert/>
		    
		    <h:panelGrid id="buttonsPlain${id}" columns="4" rendered="${not ajax}">
				<h:commandButton
					id="createPlainB${id}" 
					rendered="${(crud.state=='ADD') or (crud.state == null) or (crud.state=='UNKNOWN')}"
					styleClass="${formButtonClass}" 
					value="Create" 
					action="${crud.create}"/>			
				<h:commandButton 
					id="updatePlainB${id}" 
					rendered="${(crud.state=='EDIT')}" 
					styleClass="${formButtonClass}" 
					value="Update" 
					action="${crud.update}"/>			
				<h:commandButton 
				    id="resetPlainB${id}"
					value="Reset"
					styleClass="${formButtonClass}" 
					type="reset"/>
				<h:commandButton 
					id="cancelPlainB${id}" 
					value="Cancel"
					rendered="${((crud.state=='ADD') or (crud.state == 'EDIT') or (cancelAlwaysOn)) and not hideCancel }"
					styleClass="${formButtonClass}" 
					action="${crud.cancel}"/>			
			</h:panelGrid>
			
		    <h:panelGrid id="buttons${id}" columns="4" rendered="${ajax}">
			    	  
				<a4j:commandButton 
					id="createAjaxB${id}" 
					rendered="${(crud.state=='ADD') or (crud.state == null) or (crud.state=='UNKNOWN') }"
					reRender="${reRenderers}" 
					styleClass="${formButtonClass}"
					value="Create" 
					action="${crud.create}"/>		
				<a4j:commandButton 
					id="updateAjaxB${id}" 
					rendered="${(crud.state=='EDIT')}" 
					reRender="${reRenderers}" 
					styleClass="${formButtonClass}" 
					value="Update" 
					action="${crud.update}"/>			
				<a4j:commandButton 
					id="resetAjaxB${id}" 
					value="Reset"
					reRender="${reRenderers}" 
					styleClass="${formButtonClass}" 
					type="reset"/>
				<a4j:commandButton 
					id="cancelAjaxB${id}" 
					value="Cancel"
					immediate="true"
					rendered="${((crud.state=='ADD') or (crud.state == 'EDIT') or (cancelAlwaysOn)) and not hideCancel }"
					reRender="${reRenderers}" 
					styleClass="${formButtonClass}" 
					type="button"
					action="${crud.cancel}"/>

			</h:panelGrid>

		</h:panelGrid>

</ui:composition>

</html>

